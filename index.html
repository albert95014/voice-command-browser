<!DOCTYPE html>
<html>
<head lang="en">
	<meta charset="UTF-8">
	<title>Example of Speech Recognition</title>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
	<script>
		$(document).ready(function() {

			if (!('webkitSpeechRecognition' in window)) {
				upgrade();
			} else {
				var recognition = new webkitSpeechRecognition();
				recognition.continuous = false;
				recognition.interimResults = false;

				recognition.onstart = function() {};
				recognition.onresult = function(event) {
					var interim_transcript = '';

					for (var i = event.resultIndex; i < event.results.length; ++i) {
						if (event.results[i].isFinal) {
							final_transcript += event.results[i][0].transcript;
						} else {
							interim_transcript += event.results[i][0].transcript;
						}
					}
				var potentialcommand = $("#command").val();

				var re = /^(click|scroll|enter)\s(.*)/i; //regular expression
				var result = re.exec(final_transcript);

				if(result) {
					var verb = result[1];
					var arg = result[2]

					console.log("verb: " + verb + ", args: " + arg);

					switch(verb) {
						case "click":
							// what do we do if click?
							console.log("handling click");

							//console.log($("*:contains('" + arg + "')"));

							var stringpieces = arg.split(/\s/);

							$("a,input,button").each(function() {
								if($(this)[0].tagName == "INPUT") {
									if($(this)[0].val == arg) {
										$(this)[0].click();
									}
								} else if($(this)[0].tagName == "A")) {

								}
							});

							break;
						case "scroll":
							// what do we do on scroll?
							console.log("handling scroll`")
							break;
						case "enter":
							// what do we do on enter?
							console.log("handling enter")
							break;
						default:
						console.log("sorry, that is not a recognized command")
					}


				//console.log("Scroll " + result[1]);
				//if(result[1]=="up") {
					// scroll up
				//} else if(result[1]=="down") {
					// scroll down
				//}
				}

					console.log(final_transcript);
					console.log("results" + event.results[0][0].transcript);
				};
			};
				recognition.onerror = function(event) {};
				recognition.onend = function() {};

			function startButton(event) {
				final_transcript = '';
				recognition.start();
			}

			$(".recordbutton").click(function() {
				startButton();
			});


			$("#commandbutton").click(function() {
				

			})

			$(".dogbutton").click(function() {
				alert("hello!");
			})
		});
	</script>


	<style>
		body {
			height: 2500px;
		}
	</style>
</head>

<body>
	<p>
		<input type="text" id="command"><input type="button" value="THIS BUTTON STARTS RECORDING STUFF" id="commandbutton">
	</p>

	<p>
		<input class="recordbutton" type="button" value="cat"><br>
		<input class="dogbutton" type="button" value="dog"><br>
		<a href="google.com">Google</a><br>
		<a href="cmu.edu">CMU</a><br>
	</p>
</body>
</html>